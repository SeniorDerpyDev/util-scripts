$extensions = @(
".ascx",
".asp",
".aspx",
".bash",
".bash_login",
".bash_logout",
".bash_profile",
".bashrc",
".bowerrc",
".c",
".cc",
".clj",
".cljs",
".cljx",
".clojure",
".coffee",
".config",
".cpp",
".cs",
".cshtml",
".csproj",
".css",
".csx",
".ctp",
".cxx",
".dockerfile",
".dot",
".dtd",
".editorconfig",
".edn",
".eyaml",
".eyml",
".fs",
".fsi",
".fsscript",
".fsx",
".gemspec",
".gitattributes",
".gitconfig",
".gitignore",
".go",
".h",
".handlebars",
".hbs",
".hh",
".hpp",
".htm",
".html",
".hxx",
".ini",
".jade",
".jav",
".java",
".js",
".jscsrc",
".jshintrc",
".jshtm",
".json",
".jsp",
".less",
".lua",
".m",
".makefile",
".markdown",
".md",
".mdoc",
".mdown",
".mdtext",
".mdtxt",
".mdwn",
".mkd",
".mkdn",
".ml",
".mli",
".nqp",
".p6",
".php",
".phtml",
".pl",
".pl6",
".pm",
".pm6",
".pod",
".pp",
".profile",
".properties",
".ps1",
".psd1",
".psgi",
".psm1",
".py",
".r",
".rb",
".rhistory",
".rprofile",
".rs",
".rt",
".scss",
".sh",
".shtml",
".sql",
".svg",
".svgz",
".t",
".ts",
".txt",
".vb",
".wxi",
".wxl",
".wxs",
".xaml",
".xml",
".yaml",
".yml",
".zsh"
)
$IsAdmin = [bool](([System.Security.Principal.WindowsIdentity]::GetCurrent()).groups -match "S-1-5-32-544")
if ($IsAdmin) {
	New-PSDrive -Name HKCR -PSProvider Registry -Root HKEY_CLASSES_ROOT | Out-Null
	$extensions | foreach { $p = "HKCR:\" + $_ + "\OpenWithProgids"; Remove-ItemProperty -path $p -name VSCode }
	Remove-PSDrive -Name HKCR | Out-Null
} else {
	Write-Host "Sorry, this only works in an elevated PowerShell instance"
}
